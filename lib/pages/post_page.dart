import 'package:flutter/cupertino.dart';import 'package:flutter/material.dart';import 'package:get/get.dart';import 'package:get/get_rx/src/rx_types/rx_types.dart';import 'package:google_fonts/google_fonts.dart';import 'package:loading_animations/loading_animations.dart';import 'package:url_launcher/url_launcher.dart';import 'package:whatsapp_unilink/whatsapp_unilink.dart';class Post_page extends StatefulWidget {  const Post_page({Key? key}) : super(key: key);  @override  State<Post_page> createState() => _Post_pageState();}RxBool swich2 = false.obs;final TextEditingController Post = TextEditingController();final TextEditingController number = TextEditingController();final RxString typed_post = ''.obs;final RxString typed_number = ''.obs;RxBool flag = false.obs;class _Post_pageState extends State<Post_page> {  @override  Widget build(BuildContext context) {    return Scaffold(      backgroundColor: Colors.white,      body: SafeArea(        child: Padding(          padding: EdgeInsets.symmetric(horizontal: 20),          child: SingleChildScrollView(              child: Column(            children: [              Row(                mainAxisAlignment: MainAxisAlignment.start,                children: [                  Padding(                    padding: const EdgeInsets.symmetric(vertical: 5),                    child: Container(                      width: 50,                      height: 50,                      child: IconButton(                        onPressed: () {                          Get.back();                        },                          icon:Icon(Icons.arrow_back_ios_new_sharp,size: 30,color: Color.fromRGBO(103, 74, 47, 0.9),)),                    ),                  )                ],              ),              CircleAvatar(                radius: 100,                backgroundColor: Colors.transparent,                child: Padding(                  padding: const EdgeInsets.all(8), // Border radius                  child: ClipOval(child: Image.asset('photo/nakhla (1).jpg')),                ),              ),              Obx(() {                return Container(                  width: 400,                  height: 60,                  child: TextField(                    style: GoogleFonts.tajawal(fontSize: 18),                    textDirection: TextDirection.rtl,                    onChanged: (text) {                      typed_number.value = text;                    },                    obscureText: false,                    controller: number,                    decoration: InputDecoration(                        hintTextDirection: TextDirection.rtl,                        border: OutlineInputBorder(                          borderRadius: BorderRadius.circular(18),                          borderSide: BorderSide(color: Colors.black, width: 2),                        ),                        enabledBorder: OutlineInputBorder(                          borderRadius: BorderRadius.circular(18.0),                          borderSide: BorderSide(                            width: 2,                            color: Colors.black26,                          ),                        ),                        //errorBorder:InputDecoration.errorText,                        prefixIcon: Icon(Icons.phone,size: 30,                            color: typed_number.value.isEmpty                                ?  Colors.black45                                : Color.fromRGBO(144, 195, 70, 1)),                        hintText: " رقم الهاتف :",                        hintStyle: GoogleFonts.tajawal(fontSize: 20),                        contentPadding: const EdgeInsets.symmetric(                            horizontal: 5, vertical: 19)),                    keyboardType: TextInputType.phone,                    maxLines: 1, // <-- SEE HERE                  ),                );              }),              SizedBox(height: 40,),              Obx(() {                return Container(                  width: 400,                  height: 200,                  child: TextField(                    style: GoogleFonts.tajawal(fontSize: 18),                    textDirection: TextDirection.rtl,                    onChanged: (text) {                      typed_post.value = text;                    },                    obscureText: false,                    controller: Post,                    decoration: InputDecoration(                        hintTextDirection: TextDirection.rtl,                        border: OutlineInputBorder(                          borderRadius: BorderRadius.circular(18),                          borderSide: BorderSide(color: Colors.black, width: 2),                        ),                        enabledBorder: OutlineInputBorder(                          borderRadius: BorderRadius.circular(18.0),                          borderSide: BorderSide(                            width: 2,                            color: Colors.black26,                          ),                        ),                        //errorBorder:InputDecoration.errorText,                        prefixIcon: Icon(Icons.production_quantity_limits_sharp,size: 30,                            color: typed_post.value.isEmpty                                ? Colors.black45                                : Color.fromRGBO(144, 195, 70, 1)),                        hintText: " ادخل  النص :",                        hintStyle: GoogleFonts.tajawal(fontSize: 20),                        contentPadding: const EdgeInsets.symmetric(                            horizontal: 5, vertical: 19)),                    keyboardType: TextInputType.multiline,                    maxLines: 10, // <-- SEE HERE                  ),                );              }),              Container(                  margin: EdgeInsets.only(top: 50, left: 30, right: 30),                  width: 337,                  height: 60,                  child: RawMaterialButton(                    onPressed: () {                      print("flag : ${flag.value}");                      flag.value = true;                      print("flag : ${flag.value}");                      if(validdata()==true) {                        Future.delayed(Duration(seconds: 3), () {                          launchWhatsApp(text: post_data(), number: number.text);                          flag.value =false;                        });                      }                      Future.delayed(Duration(seconds: 3), () {                        flag.value =false;                      });                    },                    fillColor: Color.fromRGBO(144, 195, 70, 0.9),                    shape: RoundedRectangleBorder(                        borderRadius: BorderRadius.circular(18)),                    child: Obx(                      () {                        return Padding(                          padding: const EdgeInsets.only(top: 5),                          child: flag.value == true?LoadingFadingLine.circle(                              size: 80,                              backgroundColor: Color.fromRGBO(103, 74, 47, 0.9)):Text(                            "ارسال المنشور",                            style: GoogleFonts.tajawal(                                fontSize: 25,                                fontWeight: FontWeight.w700,                                color: Colors.white),                          )                        );                      }                    )                  )),              SizedBox(height: 20,),            ],          )),        ),      ),    );  }  launchWhatsApp({required String? text,required String number}) async {    WhatsAppUnilink link = WhatsAppUnilink(      phoneNumber: '964$number',      text: text,    );    await launch('$link');  }  validdata(){    if (typed_number.isEmpty ) {      Get.showSnackbar(GetSnackBar(          backgroundColor: Colors.red,          duration: Duration(seconds: 2),          messageText: Text(            'الرقم فارغ ',            textDirection: TextDirection.rtl,            style: GoogleFonts.tajawal(              fontSize: 20,            ),          )));    }else if (typed_post.isEmpty  ) {      Get.showSnackbar(GetSnackBar(          backgroundColor: Colors.red,          duration: Duration(seconds: 2),          messageText: Text(            'المنشور فارغ ',            textDirection: TextDirection.rtl,            style: GoogleFonts.tajawal(              fontSize: 20,            ),          )));    }    else {      return true;    }  }  post_data(){    String text_test = typed_post.value;    String test1 =        "# متجر نخلة\n يقدم افضل العروض ب انسب الاسعار ";    String test3 =        "للاستفسار : 07722288942   \n (فايبر-واتساب-تيلغرام)";    String total= "${test1}\n\n${text_test} \n\n${test3}";    return total;  }}